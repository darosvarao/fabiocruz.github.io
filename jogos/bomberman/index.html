<!DOCTYPE html>
<html lang="PT">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bomberman Neon - Cyberpunk Edition</title>
    <link rel="stylesheet" href="css/game-style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#00ffff">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading" class="screen">
        <div class="loading-container">
            <div class="neon-logo">
                <h1 class="glitch" data-text="BOMBERMAN NEON">BOMBERMAN NEON</h1>
                <h2>CYBERPUNK EDITION</h2>
            </div>
            <div class="loading-bar">
                <div class="loading-progress"></div>
            </div>
            <p class="loading-text">Carregando matriz cyberpunk...</p>
        </div>
    </div>

    <!-- Main Menu -->
    <div id="mainMenu" class="screen hidden">
        <div class="menu-container">
            <div class="neon-title">
                <h1 class="glitch" data-text="BOMBERMAN NEON">BOMBERMAN NEON</h1>
                <p class="subtitle">CYBERPUNK EDITION</p>
            </div>
            
            <div class="character-preview">
                <img src="assets/sprites/characters/axol_neon.png" alt="Axol" class="character-showcase">
            </div>
            
            <div class="menu-buttons">
                <button id="startGame" class="neon-btn primary">
                    <span class="btn-text">INICIAR MISS√ÉO</span>
                </button>
                <button id="selectCharacter" class="neon-btn secondary">
                    <span class="btn-text">SELECIONAR AGENTE</span>
                </button>
                <button id="instructions" class="neon-btn tertiary">
                    <span class="btn-text">PROTOCOLO</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Character Selection -->
    <div id="characterSelect" class="screen hidden">
        <div class="character-select-container">
            <h2 class="section-title">SELECIONAR AGENTE</h2>
            
            <div class="characters-grid">
                <div class="character-option selected" data-character="axol">
                    <div class="character-card">
                        <img src="assets/sprites/characters/axol_neon.png" alt="Axol">
                        <h3>AXOL</h3>
                        <p>Agente Aqu√°tico</p>
                        <div class="stats">
                            <div class="stat">Velocidade: ‚≠ê‚≠ê‚≠ê</div>
                            <div class="stat">Resist√™ncia: ‚≠ê‚≠ê‚≠ê‚≠ê</div>
                        </div>
                    </div>
                </div>
                
                <div class="character-option" data-character="bisou">
                    <div class="character-card">
                        <img src="assets/sprites/characters/bisou_neon.png" alt="Bisou">
                        <h3>BISOU</h3>
                        <p>Agente Furtivo</p>
                        <div class="stats">
                            <div class="stat">Velocidade: ‚≠ê‚≠ê‚≠ê‚≠ê</div>
                            <div class="stat">Agilidade: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                        </div>
                    </div>
                </div>
                
                <div class="character-option" data-character="pepeca">
                    <div class="character-card">
                        <img src="assets/sprites/characters/pepeca_neon.png" alt="Pepeca">
                        <h3>PEPECA</h3>
                        <p>Agente Pesado</p>
                        <div class="stats">
                            <div class="stat">For√ßa: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                            <div class="stat">Resist√™ncia: ‚≠ê‚≠ê‚≠ê‚≠ê</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="character-buttons">
                <button id="backToMenu" class="neon-btn secondary">VOLTAR</button>
                <button id="confirmCharacter" class="neon-btn primary">CONFIRMAR</button>
            </div>
        </div>
    </div>

    <!-- Instructions -->
    <div id="instructionsScreen" class="screen hidden">
        <div class="instructions-container">
            <h2 class="section-title">PROTOCOLO DE MISS√ÉO</h2>
            
            <div class="instructions-content">
                <div class="instruction-block">
                    <h3>CONTROLES</h3>
                    <div class="controls-grid">
                        <div class="control-item">
                            <span class="key">‚Üë‚Üì‚Üê‚Üí</span>
                            <span>Movimento</span>
                        </div>
                        <div class="control-item">
                            <span class="key">ESPA√áO</span>
                            <span>Bomba EMP</span>
                        </div>
                        <div class="control-item">
                            <span class="key">ESC</span>
                            <span>Pausar</span>
                        </div>
                    </div>
                </div>
                
                <div class="instruction-block">
                    <h3>OBJETIVO</h3>
                    <p>Destrua todas as estruturas da matriz e elimine amea√ßas usando bombas EMP.</p>
                </div>
                
                <div class="instruction-block">
                    <h3>POWER-UPS</h3>
                    <div class="powerups-grid">
                        <div class="powerup-item">
                            <span class="powerup-icon">‚ö°</span>
                            <span>Boost de Velocidade</span>
                        </div>
                        <div class="powerup-item">
                            <span class="powerup-icon">üí£</span>
                            <span>Bombas Extras</span>
                        </div>
                        <div class="powerup-item">
                            <span class="powerup-icon">üî•</span>
                            <span>Alcance Ampliado</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <button id="backToMenuFromInstructions" class="neon-btn secondary">VOLTAR</button>
        </div>
    </div>

    <!-- Game Screen -->
    <div id="gameScreen" class="screen hidden">
        <div class="game-container">
            <div class="game-hud">
                <div class="hud-left">
                    <div class="stat-display">
                        <span class="stat-label">PONTOS:</span>
                        <span id="score" class="stat-value">0</span>
                    </div>
                    <div class="stat-display">
                        <span class="stat-label">N√çVEL:</span>
                        <span id="level" class="stat-value">1</span>
                    </div>
                </div>
                <div class="hud-center">
                    <button id="pauseBtn" class="hud-btn">‚è∏</button>
                </div>
                <div class="hud-right">
                    <div class="stat-display">
                        <span class="stat-label">VIDAS:</span>
                        <span id="lives" class="stat-value">3</span>
                    </div>
                </div>
            </div>
            
            <div class="game-area">
                <canvas id="gameCanvas" width="416" height="352" style="width:800px;height:600px"></canvas>
            </div>
            
            <!-- Touch Controls -->
            <div id="touchControls" class="touch-controls">
                <div class="dpad">
                    <button class="dpad-btn up" data-direction="up">‚Üë</button>
                    <button class="dpad-btn left" data-direction="left">‚Üê</button>
                    <button class="dpad-btn center"></button>
                    <button class="dpad-btn right" data-direction="right">‚Üí</button>
                    <button class="dpad-btn down" data-direction="down">‚Üì</button>
                </div>
                <div class="action-buttons">
                    <button id="bombBtn" class="action-btn">üí£</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Pause Screen -->
    <div id="pauseScreen" class="screen hidden">
        <div class="pause-container">
            <h2 class="pause-title">MISS√ÉO PAUSADA</h2>
            <div class="pause-buttons">
                <button id="resumeGame" class="neon-btn primary">CONTINUAR</button>
                <button id="backToMenuFromPause" class="neon-btn secondary">MENU PRINCIPAL</button>
            </div>
        </div>
    </div>

    <!-- Game Over -->
    <div id="gameOverScreen" class="screen hidden">
        <div class="gameover-container">
            <h2 class="gameover-title">MISS√ÉO FINALIZADA</h2>
            <div class="final-stats">
                <p>Pontua√ß√£o Final: <span id="finalScore">0</span></p>
                <p>N√≠vel Alcan√ßado: <span id="finalLevel">1</span></p>
            </div>
            <div class="gameover-buttons">
                <button id="playAgain" class="neon-btn primary">NOVA MISS√ÉO</button>
                <button id="backToMenuFromGameOver" class="neon-btn secondary">MENU PRINCIPAL</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/game.js"></script>
    <script src="js/main.js"></script>

        // MAIN APPLICATION CLASS
        class BombermanApp {
            constructor() {
                this.currentScreen = 'loading';
                this.selectedCharacter = 'axol';
                this.game = null;
                
                this.init();
            }
            
            init() {
                console.log('üöÄ Inicializando Bomberman Neon...');
                this.setupEventListeners();
                this.showLoadingScreen();
                
                // Simulate loading
                setTimeout(() => {
                    this.showMainMenu();
                }, 2000);
            }
            
            setupEventListeners() {
                console.log('‚öôÔ∏è Configurando event listeners...');
                
                // Menu buttons
                this.addClickListener('startGame', () => this.startGame());
                this.addClickListener('selectCharacter', () => this.showCharacterSelect());
                this.addClickListener('instructions', () => this.showInstructions());
                
                // Character selection
                document.querySelectorAll('.character-option').forEach(option => {
                    option.addEventListener('click', () => {
                        // Remove selection from all
                        document.querySelectorAll('.character-option').forEach(opt => 
                            opt.classList.remove('selected'));
                        
                        // Add selection to clicked
                        option.classList.add('selected');
                        this.selectedCharacter = option.dataset.character;
                        
                        // Update preview
                        const preview = document.querySelector('.character-showcase');
                        if (preview) {
                            preview.src = `assets/sprites/characters/${this.selectedCharacter}_neon.png`;
                        }
                        
                        console.log('‚úÖ Personagem selecionado:', this.selectedCharacter);
                    });
                });
                
                // Navigation buttons
                this.addClickListener('backToMenu', () => this.showMainMenu());
                this.addClickListener('confirmCharacter', () => this.showMainMenu());
                this.addClickListener('backToMenuFromInstructions', () => this.showMainMenu());
                this.addClickListener('backToMenuFromPause', () => this.showMainMenu());
                this.addClickListener('backToMenuFromGameOver', () => this.showMainMenu());
                
                // Game controls
                this.addClickListener('pauseBtn', () => this.pauseGame());
                this.addClickListener('resumeGame', () => this.resumeGame());
                this.addClickListener('playAgain', () => this.startGame());
                
                // Touch controls
                this.setupTouchControls();
                
                // Keyboard controls
                document.addEventListener('keydown', (e) => this.handleKeyDown(e));
                document.addEventListener('keyup', (e) => this.handleKeyUp(e));
                
                console.log('‚úÖ Event listeners configurados!');
            }
            
            addClickListener(id, callback) {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('click', callback);
                    console.log(`‚úÖ Listener adicionado para: ${id}`);
                } else {
                    console.warn(`‚ö†Ô∏è Elemento n√£o encontrado: ${id}`);
                }
            }
            
            setupTouchControls() {
                // D-pad controls
                document.querySelectorAll('.dpad-btn').forEach(btn => {
                    if (btn.dataset.direction) {
                        btn.addEventListener('touchstart', (e) => {
                            e.preventDefault();
                            if (this.game) {
                                this.game.handleInput(btn.dataset.direction, true);
                            }
                        });
                        btn.addEventListener('touchend', (e) => {
                            e.preventDefault();
                            if (this.game) {
                                this.game.handleInput(btn.dataset.direction, false);
                            }
                        });
                    }
                });
                
                // Bomb button
                this.addClickListener('bombBtn', () => {
                    if (this.game) {
                        this.game.placeBomb();
                    }
                });
            }
            
            handleKeyDown(e) {
                if (this.currentScreen === 'gameScreen' && this.game) {
                    switch(e.code) {
                        case 'ArrowUp':
                        case 'KeyW':
                            e.preventDefault();
                            this.game.handleInput('up', true);
                            break;
                        case 'ArrowDown':
                        case 'KeyS':
                            e.preventDefault();
                            this.game.handleInput('down', true);
                            break;
                        case 'ArrowLeft':
                        case 'KeyA':
                            e.preventDefault();
                            this.game.handleInput('left', true);
                            break;
                        case 'ArrowRight':
                        case 'KeyD':
                            e.preventDefault();
                            this.game.handleInput('right', true);
                            break;
                        case 'Space':
                            e.preventDefault();
                            this.game.placeBomb();
                            break;
                        case 'Escape':
                            e.preventDefault();
                            this.pauseGame();
                            break;
                    }
                }
            }
            
            handleKeyUp(e) {
                if (this.currentScreen === 'gameScreen' && this.game) {
                    switch(e.code) {
                        case 'ArrowUp':
                        case 'KeyW':
                            this.game.handleInput('up', false);
                            break;
                        case 'ArrowDown':
                        case 'KeyS':
                            this.game.handleInput('down', false);
                            break;
                        case 'ArrowLeft':
                        case 'KeyA':
                            this.game.handleInput('left', false);
                            break;
                        case 'ArrowRight':
                        case 'KeyD':
                            this.game.handleInput('right', false);
                            break;
                    }
                }
            }
            
            showScreen(screenId) {
                console.log(`üîÑ Mudando para tela: ${screenId}`);
                
                // Hide all screens
                document.querySelectorAll('.screen').forEach(screen => {
                    screen.classList.add('hidden');
                });
                
                // Show target screen
                const targetScreen = document.getElementById(screenId);
                if (targetScreen) {
                    targetScreen.classList.remove('hidden');
                    this.currentScreen = screenId;
                    console.log(`‚úÖ Tela ativa: ${screenId}`);
                } else {
                    console.error(`‚ùå Tela n√£o encontrada: ${screenId}`);
                }
            }
            
            showLoadingScreen() {
                this.showScreen('loading');
            }
            
            showMainMenu() {
                this.showScreen('mainMenu');
                if (this.game) {
                    this.game.destroy();
                    this.game = null;
                }
            }
            
            showCharacterSelect() {
                this.showScreen('characterSelect');
            }
            
            showInstructions() {
                this.showScreen('instructionsScreen');
            }
            
            startGame() {
                console.log(`üéÆ Iniciando jogo com personagem: ${this.selectedCharacter}`);
                this.showScreen('gameScreen');
                
                const canvas = document.getElementById('gameCanvas');
                if (canvas) {
                    this.game = new BombermanGame(canvas, this.selectedCharacter);
                    
                    this.game.onGameOver = (score, level) => {
                        this.showGameOver(score, level);
                    };
                    
                    this.game.onScoreUpdate = (score, level, lives) => {
                        this.updateHUD(score, level, lives);
                    };
                    
                    this.game.start();
                    console.log('‚úÖ Jogo iniciado!');
                } else {
                    console.error('‚ùå Canvas n√£o encontrado!');
                }
            }
            
            pauseGame() {
                if (this.game) {
                    this.game.pause();
                    this.showScreen('pauseScreen');
                }
            }
            
            resumeGame() {
                if (this.game) {
                    this.game.resume();
                    this.showScreen('gameScreen');
                }
            }
            
            showGameOver(score, level) {
                document.getElementById('finalScore').textContent = score;
                document.getElementById('finalLevel').textContent = level;
                this.showScreen('gameOverScreen');
            }
            
            updateHUD(score, level, lives) {
                document.getElementById('score').textContent = score;
                document.getElementById('level').textContent = level;
                document.getElementById('lives').textContent = lives;
            }
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üåü DOM carregado, inicializando aplica√ß√£o...');
            window.bombermanApp = new BombermanApp();
        });
    </script>
</body>
</html>

